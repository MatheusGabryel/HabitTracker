<div class="habit-card" @fadeInOut [class.expanded]="showDetails">
  <div class="habit-main">
    <div class="dinamic-status" title="ConcluÃ­do">
      @if(getTodayState() === "in_progress") {
      <button class="status-button" (click)="markHabit()">
        <img @fadeInOut src="./assets/icon/circle.png" width="30px" alt="" />
      </button>
      } @if(getTodayState() === "completed") {
      <button class="status-button" (click)="markHabit()">
        <img @fadeInOut src="./assets/icon/check.png" width="30px" alt="" />
      </button>
      } @if(getTodayState() === "failed") {
      <button class="status-button" (click)="markHabit()">
        <img @fadeInOut src="./assets/icon/close.png" width="30px" alt="" />
      </button>
      }
    </div>

    <div class="name">
      <span>{{ habit?.name }}</span>
    </div>

    @if (category) {
    <div class="category">
      <div
        [title]="category.displayName"
        class="icon-wrapper"
        [ngStyle]="{ backgroundColor: category.color }"
      >
        <img [src]="category.icon" [alt]="category.displayName" />
      </div>
    </div>
    } @if(getTodayState() === "in_progress") {
    <div class="status">
      <span class="in_progress" @fadeInOut>Em progresso</span>
    </div>
    } @if(getTodayState() === "completed") {
    <div class="status">
      <span class="completed" @fadeInOut>Completo</span>
    </div>
    } @if(getTodayState() === "failed") {
    <div class="status">
      <span class="failed" @fadeInOut>Falhado</span>
    </div>
    }

    <div class="days-mobile">
      <app-habit-days
        [logs]="logs"
        [habit]="habit"
        [habitId]="habit.id"
        [habitRule]="habit.timesTarget?.rule || habit.timeTarget?.rule"
        [days]="days"
        (logUpdated)="reloadLogs()"
      ></app-habit-days>
    </div>

    <div class="priority">
      @if (habit.priority === 'high') {
      <span class="priority" @fadeInOut>Alta</span>
      } @if (habit.priority === 'medium-high') {
      <span class="priority" @fadeInOut>MÃ©dia-Alta</span>
      } @if (habit.priority === 'medium') {
      <span class="priority" @fadeInOut>MÃ©dia</span>
      } @if (habit.priority === 'low') {
      <span class="priority" @fadeInOut>Baixa</span>
      }
    </div>

    <div class="habit-actions">
      <button class="delete-button" title="Deletar" (click)="emitDelete()">
        ðŸ—‘
      </button>
      <button class="expand-button" title="Ver mais" (click)="toggleDetails()">
        â¤¢
      </button>
      <button class="edit-button" title="Editar hÃ¡bito">â‹®</button>
    </div>
  </div>
  <div
    class="details"
    [@expandCollapse]="showDetails ? 'expanded' : 'collapsed'"
  >
    <swiper-container
      slides-per-view="1"
      loop="false"
      pagination="true"
      space-between="16"
      class="swiper"
    >
      <swiper-slide>
        <div class="slide-content">
          <div>Slide 1 - Detalhes do hÃ¡bito</div>

          <div class="days-desktop">
            <app-habit-days
              [logs]="logs"
              [habit]="habit"
              [habitId]="habit.id"
              [habitRule]="habit.timesTarget?.rule || habit.timeTarget?.rule"
              [days]="days"
              (logUpdated)="reloadLogs()"
            ></app-habit-days>
          </div>

          <div class="summary">
            ConcluÃ­do: 57% na semana
            <button class="calendar-button">ðŸ“… Ver calendÃ¡rio</button>
          </div>

          <div class="created-date">Criado em: 12/06/2025</div>

          @if (habit.description) {
          <div class="description">DescriÃ§Ã£o: {{ habit.description }}</div>
          }
        </div>
      </swiper-slide>
      <swiper-slide>
        <div class="slide-content">
          <div>Slide 2 - EstatÃ­stica</div>
        </div>
      </swiper-slide>
    </swiper-container>
  </div>
</div>
