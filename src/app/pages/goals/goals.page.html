<ion-content>
  <div class="app-container">
    <app-menu></app-menu>

    <div class="main-container">
      <app-header></app-header>

      <main class="page-content">
        @if (showGoalModal) {
        <app-create-goal-modal
          (close)="closeModal()"
          @fadeInOut
        ></app-create-goal-modal>
        } @if(showFilterModal) {
        <app-filter-goal-modal
         (close)="closeModal()" 
         @fadeInOut
         (filtersApplied)="onFiltersApplied($event)"
         [initialFilters]="activeFilters"
         >
        </app-filter-goal-modal>
        } @if (showEditGoalModal) {
        <app-edit-goal-modal
          [goalToEdit]="goalToEdit"
          (close)="closeModal()"
          @fadeInOut
        ></app-edit-goal-modal>
        }

        <section class="header-goal">
          <div class="text">
            <h1>Transforme seus hábitos em objetivos concretos!</h1>
            <p>
              Conecte seus esforços diários a metas reais e recompensas que
              fazem sentido pra você.
            </p>
          </div>
          <div class="create-goal">
            <div class="create-goal-card" (click)="openModal()">
              <div>
                <img
                  src="./assets/icon/emoji_events_100dp_FFFFFF.png"
                  alt="a"
                  class="card-icon"
                />
                <p>Nova Meta</p>
              </div>
              <div>
                <img
                  src="./assets/icon/add_250dp_000000.png"
                  alt=""
                  class="add-icon"
                />
              </div>
            </div>
          </div>
        </section>
        <section class="list-goal">
          <div class="list-header">
            <div class="left">
              <h2>Lista de Metas</h2>
              <div class="search-bar">
                <img
                  src="./assets/icon/search_100dp_434343.png"
                  alt=""
                  width="25px"
                />
                <input
                  type="text"
                  placeholder="Buscar meta... "
                  [(ngModel)]="searchText"
                  (ngModelChange)="onSearchChange()"
                />
              </div>
            </div>

            <button class="filter" (click)="openFilterModal()">
              <img src="./assets/icon/tune_100dp_434343.png" alt="" />
              <p>Filters</p>
            </button>
          </div>
          <div class="goal-list-card-wrapper">
            @if (!loading) { @if (hasGoals) {
            <ul class="goal-list-cards">
              @for (goal of filteredGoals; track goal.id) {
              <li>
                <app-goal-card
                  [goal]="goal"
                  (delete)="deleteGoal($event)"
                  (complete)="completeGoal($event)"
                  (restore)="restoreGoal($event)"
                  (cancel)="cancelGoal($event)"
                  (edit)="openEditGoalModal($event)"
                ></app-goal-card>
              </li>
              }
            </ul>
            } @else {
            <div class="empty-state">
              <img
                src="./assets/icon/emoji_events_100dp_FFFFFF.png"
                alt="Nenhuma meta"
                class="empty-icon"
              />
              <p>Você ainda não criou nenhuma meta</p>
              <p class="empty-subtitle">Transforme seus hábitos em objetivos concretos e alcance seus sonhos!</p>
              <button class="create-button" (click)="openModal()">Criar Meta</button>
            </div>
            } }
          </div>
        </section>
      </main>
    </div>
  </div>
</ion-content>
